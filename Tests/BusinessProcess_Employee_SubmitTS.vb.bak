Imports NUnit.Framework

<TestFixture>
Public Class BusinessProcess_Employee_SubmitTS
    Private _userEmployee As New User
    Private _timesheetEmployee As New TimeSheet
    Private _timesheetEmployeeRetrieved As New TimeSheet
    Private _tasktypeNormalDay As New TaskType
    Private _dtUserTimesheet As New DataTable

    <SetUp>
    Protected Sub SetUp()
        With _tasktypeNormalDay
            .Name = "Normal Day"
            .ChargePerHour = 100
        End With

        With _userEmployee
            .Id = 1
            .FullName = "First Employee"
            .Password = "employee1"
            .Email = "employee.1@company.co.id"
            .IsActive = True
        End With

    End Sub

    <TearDown>
    Protected Sub Cleanup()

    End Sub

    <Test>
    Public Sub BusinessProcess_Employee_SubmitTS()
        Assert.IsTrue(_userEmployee.Login())
        If _userEmployee.Login() Then
            ' Create timesheet 
            With _timesheetEmployee
                .Id = _userEmployee.Id
                .HourActual = 8
                .HourPlanned = 8
                .TaskType = _tasktypeNormalDay
            End With

            ' Search timesheet
            _dtUserTimesheet = TimeSheet.LoadAllTimeSheet(_userEmployee.Id)
            _timesheetEmployeeRetrieved = TimeSheet.SelectTimesheetFromTable(_userEmployee.Id, _timesheetEmployee.Number, _dtUserTimesheet)
            Assert.AreEqual(_timesheetEmployeeRetrieved.Id, _timesheetEmployee.Id)
            Assert.AreEqual(_timesheetEmployeeRetrieved.HourActual, _timesheetEmployee.HourActual)
            Assert.AreEqual(_timesheetEmployeeRetrieved.HourPlanned, _timesheetEmployee.HourPlanned)




        End If
    End Sub
End Class